#!/usr/bin/env python3

import scanner

target_url = "http://192.168.122.131/dvwa/"
links_to_ignore = ["http://192.168.122.131/dvwa/logout.php"]
data_dict = {"username": "admin", "password": "password", "Login": "submit"}
vuln_scanner = scanner.Scanner(target_url, links_to_ignore)
vuln_scanner.session.post("http://192.168.122.131/dvwa/login.php", data_dict)

vuln_scanner.crawl()
vuln_scanner.run_scanner()

# Test injecting code
# forms = vuln_scanner.extract_forms
# ("http://192.168.122.131/dvwa/vulnerabilities/xss_r/")
# response = vuln_scanner.test_xss_in_form(forms[0],
# "http://192.168.122.131/dvwa/vulnerabilities/xss_r/")
# response = vuln_scanner.test_xss_in_link
# ("http://192.168.122.131/dvwa/vulnerabilities/xss_r/?name=test")
# print(response)


# Test crawler
# target_url = "http://192.168.122.131/mutillidae/"
# vuln_scanner = scanner.Scanner(target_url)
# vuln_scanner.crawl()
